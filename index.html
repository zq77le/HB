<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>ç”Ÿæ—¥å¿«ä¹ï¼</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { text-align:center; background: linear-gradient(to right,#ffdde1,#ee9ca7); font-family: 'Segoe UI',sans-serif; color:#fff; margin:0; padding:0; }
    h1 { font-size:2.4rem; margin-top:12vh; }
    p.sub { color: rgba(255,255,255,0.9); margin-top:8px; }
    .btn { margin:18px 8px; font-size:1rem; padding:10px 18px; border-radius:10px; border:2px solid #fff; background:rgba(255,255,255,0.15); color:#fff; cursor:pointer; }
    .btn:hover { transform:scale(1.03); background: rgba(255,255,255,0.28); }
    #letter { display:none; margin:20px auto; max-width:600px; background:#fff; color:#222; padding:18px; border-radius:12px; box-shadow:0 6px 20px rgba(0,0,0,0.15); line-height:1.6; }
    #status { margin-top:6px; font-size:0.9rem; color:rgba(255,255,255,0.9); }
  </style>
</head>
<body>
  <h1>ğŸ‚ ç”Ÿæ—¥å¿«ä¹ï¼ ğŸ‰</h1>
  <p class="sub">ç‚¹ä¸‹é¢æŒ‰é’®å¼€å¯éŸ³ä¹å¹¶æŸ¥çœ‹æˆ‘å†™ç»™ä½ çš„ä¿¡ï½</p>

  <!-- éŸ³ä¹ï¼ˆPage URL â€”â€” æ¨èï¼‰ -->
  <audio id="bg-music" autoplay loop muted preload="auto">
    <source src="https://zq77le.github.io/HB/music/HappyBirthday.mp3" type="audio/mpeg">
    æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ audioã€‚
  </audio>

  <div>
    <button id="musicBtn" class="btn">ğŸ”Š å¼€å¯éŸ³ä¹</button>
    <button id="letterBtn" class="btn" style="display:none">ğŸ“© æ‰“å¼€ä¿¡ä»¶</button>
  </div>

  <div id="status" aria-live="polite"></div>

  <div id="letter">
    <h2>ç»™ä½ çš„ä¸€å°ä¿¡ ğŸ’–</h2>
    <p>äº²çˆ±çš„æœ‹å‹ï¼Œç”Ÿæ—¥å¿«ä¹ï¼æ„Ÿè°¢ä½ ä¸€ç›´ä»¥æ¥çš„é™ªä¼´ä¸æ”¯æŒï¼Œæ„¿ä½ çš„æ¯ä¸€å¤©éƒ½å……æ»¡å¿«ä¹ä¸æƒŠå–œï¼ğŸ‰</p>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const music = document.getElementById('bg-music');
      const musicBtn = document.getElementById('musicBtn');
      const letterBtn = document.getElementById('letterBtn');
      const letter = document.getElementById('letter');
      const status = document.getElementById('status');

      // æ˜¾ç¤ºå½“å‰éŸ³é¢‘æºï¼Œä¾¿äºè°ƒè¯•
      status.textContent = 'éŸ³é¢‘æº: ' + (music.currentSrc || music.src);

      // ç›‘å¬åŠ è½½æˆåŠŸ / å¤±è´¥
      music.addEventListener('canplaythrough', () => {
        console.log('audio canplaythrough');
        status.textContent = 'éŸ³ä¹å·²å°±ç»ªï¼Œç‚¹å‡»ã€Œå¼€å¯éŸ³ä¹ã€æ’­æ”¾ã€‚';
      });
      music.addEventListener('error', (e) => {
        console.error('audio error', e);
        status.textContent = 'âš ï¸ éŸ³é¢‘åŠ è½½å¤±è´¥ï¼Œè¯·ç¡®è®¤è·¯å¾„å¯è®¿é—®ï¼ˆæœ€å¥½ä½¿ç”¨ https://zq77le.github.io/HB/music/HappyBirthday.mp3ï¼‰';
      });

      // ç‚¹å‡»æŒ‰é’®é€»è¾‘ï¼ˆä½¿ç”¨ eventListenerï¼Œé¿å… onclick å…¨å±€å‡½æ•°ä¾èµ–ï¼‰
      musicBtn.addEventListener('click', async () => {
        try {
          if (music.paused) {
            music.muted = false; // å–æ¶ˆé™éŸ³
            await music.play();
            musicBtn.textContent = 'â¸ æš‚åœéŸ³ä¹';
            letterBtn.style.display = 'inline-block';
            status.textContent = 'æ­£åœ¨æ’­æ”¾éŸ³ä¹ ğŸµ';
          } else {
            music.pause();
            musicBtn.textContent = 'ğŸ”Š å¼€å¯éŸ³ä¹';
            status.textContent = 'éŸ³ä¹å·²æš‚åœ';
          }
        } catch (err) {
          console.error('play() failed:', err);
          status.textContent = 'æ’­æ”¾å¤±è´¥ï¼š' + (err && err.name ? err.name : err);
          alert('æ’­æ”¾å¤±è´¥ï¼š' + (err && err.message ? err.message : err));
        }
      });

      letterBtn.addEventListener('click', () => {
        letter.style.display = 'block';
        letterBtn.style.display = 'none';
      });

      // å¯¹å¤–æš´éœ²ä¸€ä¸ªè°ƒè¯•æ–¹æ³•ï¼ˆå¯åœ¨ console è°ƒç”¨ testAudio()ï¼‰
      window.testAudio = function () {
        console.log('audio src=', music.currentSrc, 'paused=', music.paused, 'muted=', music.muted);
        alert('audio src='+music.currentSrc+'\npaused='+music.paused+'\nmuted='+music.muted);
      };
    });
  </script>
</body>
</html>

